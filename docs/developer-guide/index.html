<!DOCTYPE html>
<html lang="en">

<head>
    <title>Free Open-Source Invoicing, Expenses &amp; Time-Tracking | Invoice Ninja</title>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="referrer" content="always">
    <link rel="canonical" href="https://invoiceninja.github.io/docs/developer-guide">
    <meta name="description" content="The leading free open-source online invoicing app for freelancers &amp; businesses. Invoice, accept payments, track expenses, create proposals, &amp; time-tasks">

    <link rel="stylesheet" href="/assets/build/css/main.css?id=0a8ebcab5d11821a1d87">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />

    </head>

<nav class="py-4 sticky top-0 z-40 lg:z-50 w-full mx-auto bg-white border-b">
    <div id="navigation-content" class="flex items-center justify-between px-4 md:px-0 md:mx-4 lg:px-4 xl:mx-auto max-w-8xl">
        <a href="/" id="left-side-logo">
            <img class="h-8"
                 src="/assets/images/logo.png"
                 alt="Invoice Ninja logo"/>
        </a>
        <section id="right-side-items" class="text-sm">
            <div class="hidden md:hidden lg:block md:space-x-5">
                <input type="text" placeholder="Quick search ..." id="topSearchBox"
                       class="pb-1 border-b hover:border-ninja-blue focus:border-ninja-blue focus:outline-none">
                <a href="/docs/getting-started" class="py-2 border-b border-transparent hover:border-ninja-blue">Documentation</a>
                <a href="https://app.swaggerhub.com/apis/invoiceninja/invoiceninja" target="_blank"
                   class="py-2 border-b border-transparent hover:border-ninja-blue">API Documentation</a>
                <a href="https://app.invoiceninja.com" class="px-5 py-2 border rounded-full hover:border-ninja-blue">Go
                    to app</a>
            </div>
            <div class="flex flex-col lg:hidden">
                <button id="mobile-menu-toggle" class="focus:outline-none">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                         class="feather feather-menu">
                        <line x1="3" y1="12" x2="21" y2="12"></line>
                        <line x1="3" y1="6" x2="21" y2="6"></line>
                        <line x1="3" y1="18" x2="21" y2="18"></line>
                    </svg>
                </button>
            </div>
        </section>
    </div>
    <div id="mobile-menu" class="hidden px-4 pt-4 flex flex-col">
        <a href="/docs/getting-started"
           class="py-2 border-b border-transparent hover:border-ninja-blue">Documentation</a>
        <a href="https://app.swaggerhub.com/apis/invoiceninja/invoiceninja" target="_blank"
           class="py-2 border-b border-transparent hover:border-ninja-blue">API Documentation</a>
        <a href="https://app.invoiceninja.com" target="_blank"
           class="py-2 border-b border-transparent hover:border-ninja-blue">Go to app</a>
    </div>
</nav>
<body class="font-sans antialiased text-gray-900 bg-white ">
        <div class="hidden top-0 absolute z-40 bg-white w-full h-screen" id="mobile-menu-overlay">
       <div class="p-6 flex items-top justify-between">
           <div>
                                  <div clasS="mb-8">
                       <a class="block hover:text-ninja-blue font-semibold uppercase "
                          href="/docs/getting-started">User guide</a>

                       <div class="mt-2">
                                                          <a class="block hover:text-ninja-blue py-1 "
                                  href="/docs/introduction">Introduction</a>
                                                          <a class="block hover:text-ninja-blue py-1 "
                                  href="/docs/clients">Clients</a>
                                                          <a class="block hover:text-ninja-blue py-1 "
                                  href="/docs/invoices">Invoices</a>
                                                          <a class="block hover:text-ninja-blue py-1 "
                                  href="/docs/recurring-invoices">Recurring Invoices</a>
                                                          <a class="block hover:text-ninja-blue py-1 "
                                  href="/docs/settings">Settings</a>
                                                          <a class="block hover:text-ninja-blue py-1 "
                                  href="/docs/custom-fields">PDF customization</a>
                                                  </div>
                   </div>
                                  <div clasS="mb-8">
                       <a class="block hover:text-ninja-blue font-semibold uppercase text-ninja-blue border-ninja-blue"
                          href="/docs/developer-guide">Developer guide</a>

                       <div class="mt-2">
                                                  </div>
                   </div>
                                  <div clasS="mb-8">
                       <a class="block hover:text-ninja-blue font-semibold uppercase "
                          href="/docs/self-host-installation">Self host</a>

                       <div class="mt-2">
                                                          <a class="block hover:text-ninja-blue py-1 "
                                  href="/docs/self-host-installation">Installation</a>
                                                          <a class="block hover:text-ninja-blue py-1 "
                                  href="/docs/self-host-updating">Updating</a>
                                                          <a class="block hover:text-ninja-blue py-1 "
                                  href="/docs/self-host-troubleshooting">Troubleshooting</a>
                                                  </div>
                   </div>
                                  <div clasS="mb-8">
                       <a class="block hover:text-ninja-blue font-semibold uppercase "
                          href="/docs/migration">Migrating to V5</a>

                       <div class="mt-2">
                                                  </div>
                   </div>
                          </div>
           <div>
                <button onclick="document.getElementById('mobile-menu-overlay').classList.add('hidden');">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                </button>
           </div>
       </div>
    </div>

    <div class="max-w-8xl grid grid-cols-12 md:gap-16 py-4 px-4 lg:mx-auto">
        <div class="hidden mr-4 space-y-6 md:block lg:col-span-2">
            <div class="hidden lg:block fixed mt-2">
                                    <div clasS="mb-8">
                        <a class="block hover:text-ninja-blue font-semibold uppercase "
                           href="/docs/getting-started">User guide</a>

                        <div class="mt-2">
                                                            <a class="block hover:text-ninja-blue py-1 "
                                   href="/docs/introduction">Introduction</a>
                                                            <a class="block hover:text-ninja-blue py-1 "
                                   href="/docs/clients">Clients</a>
                                                            <a class="block hover:text-ninja-blue py-1 "
                                   href="/docs/invoices">Invoices</a>
                                                            <a class="block hover:text-ninja-blue py-1 "
                                   href="/docs/recurring-invoices">Recurring Invoices</a>
                                                            <a class="block hover:text-ninja-blue py-1 "
                                   href="/docs/settings">Settings</a>
                                                            <a class="block hover:text-ninja-blue py-1 "
                                   href="/docs/custom-fields">PDF customization</a>
                                                    </div>
                    </div>
                                    <div clasS="mb-8">
                        <a class="block hover:text-ninja-blue font-semibold uppercase text-ninja-blue border-ninja-blue"
                           href="/docs/developer-guide">Developer guide</a>

                        <div class="mt-2">
                                                    </div>
                    </div>
                                    <div clasS="mb-8">
                        <a class="block hover:text-ninja-blue font-semibold uppercase "
                           href="/docs/self-host-installation">Self host</a>

                        <div class="mt-2">
                                                            <a class="block hover:text-ninja-blue py-1 "
                                   href="/docs/self-host-installation">Installation</a>
                                                            <a class="block hover:text-ninja-blue py-1 "
                                   href="/docs/self-host-updating">Updating</a>
                                                            <a class="block hover:text-ninja-blue py-1 "
                                   href="/docs/self-host-troubleshooting">Troubleshooting</a>
                                                    </div>
                    </div>
                                    <div clasS="mb-8">
                        <a class="block hover:text-ninja-blue font-semibold uppercase "
                           href="/docs/migration">Migrating to V5</a>

                        <div class="mt-2">
                                                    </div>
                    </div>
                            </div>
        </div> <!-- End of sidebar -->

        <div class="col-span-12 md:col-span-7 p-4 prose mx-auto" style="max-width: 100% !important;" id="page-content">
            <div class="block lg:hidden flex flex-col mb-4 lg:mb-0">
                <button onclick="document.getElementById('mobile-menu-overlay').classList.remove('hidden');">&#8592; Documentation</button>
            </div>

            <h1>Developer resources</h1>

<h2>Getting Started.</h2>

<p>The Invoice Ninja API is built on top of the <a href="laravel.com">Laravel Framework</a>, this is a hugely popular PHP framework with extensive high quality documentation and tutorials all over the web. To get started customizing and/or extending Invoice Ninja you will need to be acquainted with the latest version of Laravel and all of its features. The URL namespace for the api is <strong>/api/v1</strong> The Client Portal is a traditional web application also built with Laravel along with Livewire and Tailwind components. The URL namespace for client facing URLs is <strong>/client/</strong></p>

<p>If you are planning to build new functionality in Invoice Ninja, for example a Inventory Module, rather than integrate this directly into the codebase, we highly recommend using the <a href="https://github.com/nwidart/laravel-modules">Laravel Modules</a> library. This library is already part of the Invoice Ninja core, so you can dive straight in and start building.</p>

<p>If you plan to contribute your code back to the official Invoice Ninja repository, please ensure you have test coverage for your functionality. We use <a href="https://phpunit.de/">Phpunit</a> for our API testing, and <a href="https://www.cypress.io/">Cypress</a> for our UI testing of the client portal.</p>

<h2>API Definition</h2>

<p>Our full API definition can be found on swagger <a href="https://app.swaggerhub.com/apis/invoiceninja/invoiceninja">here</a></p>

<h3>Migrating from v4</h3>

<p>Invoice Ninja v4 was initially built as a web application with an API added on later to support common uses cases and the limited functionality of the v4 mobile app. With v5 we’ve instead built an API first application, all features in the web/mobile/desktop apps are powered by the API.</p>

<p>For example v4 <a href="https://github.com/invoiceninja/invoiceninja/blob/master/app/Ninja/Transformers/ClientTransformer.php#L51">client includes</a> are limited to contacts, invoices, credits and activities, whereas in v5 where <a href="https://github.com/invoiceninja/invoiceninja/blob/v5-develop/app/Transformers/ClientTransformer.php#L32">all options</a> are available. This includes: contacts, documents, gateway_tokens, documents, gateway_tokens, activities, ledger and system_logs.</p>

<p>Another major shortcoming of the v4 API is the docs, even though the functionality is limited, what is available isn’t necessarily documented. In v5 we’ve made sure to document every aspect of the API.</p>

<p>The v4 and v5 APIs are mostly the same but there are some key changes which are important to be aware of.</p>

<p>::: warning
The header name for the API token has changed from X-Ninja-Token in v4 to X-API-Token in v5.
:::</p>

<p>The data type of the id fields has changes from integer to string to support the new id format.</p>

<p>The route for uploading documents has changed, here's a v5 cURL example:</p>

<pre><code>curl -X POST http://example.com/api/v1/invoices/&lt;invoice_id&gt; \
  -H 'Content-Type: multipart/form-data' \
  -H 'X-API-TOKEN: TOKEN' \
  -H 'X-Requested-With: XMLHttpRequest' \
  -F _method=PUT \
  -F 'documents[]=@filename.png'
</code></pre>

<h2>Adding payment gateways</h2>

<p>Payment Driver Template.</p>

<p>So you want to make a payment driver for invoice ninja, but don't know where to start? The first step would be to reach out to us directly on Slack https://invoiceninja.slack.com and have a chat to us in real time so that we can help you hit the ground running and build your driver in the most efficient way possible. Contacting us prior will also ensure that your code can be merged back into the official repository as we will be maintaining this code into the future.</p>

<p>Ready? Lets go!</p>

<h3>Step 1. Setup environment</h3>

<p>You should update your code to be up to date with the <a href="https://github.com/invoiceninja/v5-develop">v5-develop</a> branch.</p>

<p>You will then want to create your own branch for for your driver ie.</p>

<pre><code>git branch my_payment_driver
</code></pre>

<h3>Step 2. Adding the gateway into the gateways table</h3>

<p>Lets create a migration file which will insert a record identifying the gateway.</p>

<pre><code>php artisan make:migration my_new_gateway
</code></pre>

<p>Let open this file and in the up() method create our new gateway record</p>

<p>Init a new gateway instance</p>

<pre><code>$gateway = new Gateway;
$gateway-&gt;name = 'Fancy Gateway'; 
$gateway-&gt;key = Str::lower(Str::random(32)); 
$gateway-&gt;provider = ‘FancyGateway’;
$gateway-&gt;is_offsite = true;
$gateway-&gt;fields = new \stdClass;
$gateway-&gt;visible = true;
$gateway-&gt;site_url = ‘https://stripe.com’;
$gateway-&gt;default_gateway_type_id = 1;
$gateway-&gt;save();
</code></pre>

<h4>Gateway Properties</h4>

<ul>
<li>name: The name of your gateway</li>
<li>key: A random 32 alphanumeric gateway key (Type: string)</li>
<li>provider: This is a camel cased string which is used to initialize your payment driver. We append the string Driver to this class, so if you payment driver is FancyGatewayDriver, then your provider will be FancyGateway. (Type: string)</li>
<li>is_offsite: Specifies is this payment driver redirects the user to another page to complete the payment. Paypal Express for instance redirects to Paypal, and then returns the user once the payment is completed (Type: bool)</li>
<li>fields: A stdClass object of key values which defines the user settings required for the gateway, ie, Api Keys, Secrets etc. All of these fields are strings except for testMode which is a boolean and indicates whether the gateway is set to test mode. (Type stdClass)</li>
<li>visible: Defines whether the gateway should be visible in the UI (Type: bool)</li>
<li>site_url: A URL field which allows the user to go directly to the gateway page for further information (Type: string, url)</li>
<li>default_gateway_type_id: If your gateway has multiple ways to pay, ie Credit Card, Bank Transfer etc, then you’ll want to select a default method. The list of defined methods are found on the GatewayType model as follows:</li>
</ul>

<pre><code>    const CREDIT_CARD = 1;
    const BANK_TRANSFER = 2;
    const PAYPAL = 3;
    const CRYPTO = 4;
    const CUSTOM = 5;
    const ALIPAY = 6;
    const SOFORT = 7;
    const APPLE_PAY = 8;
    const SEPA = 9;
    const CREDIT = 10;
</code></pre>

            <a href="https://github.com/invoiceninja/invoiceninja.github.io/blob/v5-rework/source/docs/developer-guide.md"
               class="pt-4 border-t inline-flex items-center w-full block">
                <svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 24 24" fill="none"
                     stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                     class="feather feather-github">
                    <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
                </svg>
                <span class="ml-2">Want to contribute? Edit this page on GitHub!</span>
            </a>
        </div> <!-- End of main content -->

        <div class="hidden md:block col-span-3 p-4">
            <div class="fixed overflow-y-auto pr-10 h-full pb-32" id="toc-container">
                <!-- Placeholder for table of contents -->
                <span class="text-sm uppercase block mb-3 text-ninja-blue">On this page</span>
            </div>
        </div>
    </div>
        <script src="/assets/build/js/main.js?id=f8ae428c8ff7fbb77216"></script>

    <script>
        document.getElementById('mobile-menu-toggle').addEventListener('click', () => {
            let mobileMenu = document.getElementById('mobile-menu');

            if (mobileMenu.classList.contains('hidden')) {
                return mobileMenu.classList.remove('hidden');
            }

            return mobileMenu.classList.add('hidden');
        });
    </script>

    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
    <script type="text/javascript">
        docsearch({
            apiKey: '4816218e8381d5a17beacd84823e9ea3',
            indexName: 'invoiceninja',
            inputSelector: '#topSearchBox',
            debug: false
        });
    </script>
</body>

</html>
